<div class="sidenav" th:fragment="sidebar">
    <img src="/layout/srcs/logo.svg" alt="logo" class="logo" />
    <a href="/" class="menu">HOME</a>
    <a href="/members/rank" class="menu">유저 랭킹</a>
    <a href="#" class="menu">관심 종목</a>
    <a href="/members/asset" class="menu">자산 관리</a>
    <div class="flex-container">
        <img src="/layout/srcs/icons/user-logo.svg" alt="icon" class="flex-component" />
        <!-- 사용자 이름을 표시하고, 클릭 시 로그아웃 -->
        <a id="userName"
           class="flex-component"
           href="javascript:void(0);"
           th:text="${#authentication.principal.nickname}"
           onclick="myPage()"

           th:if="${#authorization.expression('isAuthenticated()')}"></a>

        <!-- 비로그인 시 로그인 버튼 표시 -->
        <a class="flex-component" href="/login" th:unless="${#authorization.expression('isAuthenticated()')}">
            Login
        </a>
        <input type="hidden" id="memberKey" th:value="${#authentication.principal.memberKey}"
               th:if="${#authorization.expression('isAuthenticated()')}" />
    </div>
</div>

<script th:inline="javascript" th:fragment="sidebar-script">
    function myPage() {
        window.location.href='/members/mypage';
    }

    document.addEventListener('DOMContentLoaded', function () {
        // myPage 링크에 이벤트 리스너 추가
        const mypageLink = document.querySelector('[data-action="mypage"]');
        if (mypageLink) {
            mypageLink.addEventListener('click', function() {
                axios
                    .get('/mypage')
                    .then()
                    .catch((error) => alert('마이페이지로 이동 중 오류가 발생했습니다.'));
            });
        }
    });

</script>